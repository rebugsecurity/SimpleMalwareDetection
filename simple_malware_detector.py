import os
import hashlib

def search(dir_path):

    for file_name in os.listdir(dir_path):

        full_path = os.path.join(dir_path, file_name)
        if os.path.isfile(full_path):
            with open(full_path, 'rb') as f:
                content = f.read()

                md5_hash = hashlib.md5(content).hexdigest()
                sha1_hash = hashlib.sha1(content).hexdigest()

                # add your own custom heuristics rules here to check for specific malware.
                # for example, check for known signatures, file types, or suspicious behaviors.
                # here is an example of checking for a known signature:
                if md5_hash == 'INSERT_KNOWN_MALWARE_HASH_HERE':
                    print(f'Found malware at: {full_path}')
        elif os.path.isdir(full_path):
            search(full_path)

dir_path = input("Enter a directory path to scan for malware: ")
search(dir_path)